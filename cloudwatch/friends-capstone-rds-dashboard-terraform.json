{
    "widgets": [
        {
            "height": 6,
            "width": 6,
            "y": 0,
            "x": 0,
            "type": "log",
            "properties": {
                "query": "SOURCE '/ecs/friends-capstone-cluster/friends-capstone-crud-api-service' | SOURCE '/ecs/friends-capstone-thumbnails-api-ecs-task' | fields @timestamp, @message, @logStream, @log\n| filter @message like /(?i)Can't connect to MySQL server/ \n| sort @timestamp asc\n| stats count() by bin(1h)\n| limit 10000",
                "region": "us-west-2",
                "stacked": false,
                "title": "RDS - CardDB - ConnectionErrors",
                "view": "bar"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 0,
            "x": 6,
            "type": "metric",
            "properties": {
                "view": "timeSeries",
                "stacked": false,
                "metrics": [
                    [
                        "AWS/RDS",
                        "DatabaseConnections",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "period": 60
                        }
                    ]
                ],
                "region": "us-west-2",
                "title": "RDS - CardDB - ConnectionCount"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 0,
            "x": 12,
            "type": "metric",
            "properties": {
                "view": "timeSeries",
                "stacked": false,
                "title": "RDS - CardDB - CPU Utilization",
                "metrics": [
                    [
                        "AWS/RDS",
                        "CPUUtilization",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "period": 60
                        }
                    ]
                ],
                "region": "us-west-2"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 6,
            "x": 0,
            "type": "metric",
            "properties": {
                "view": "timeSeries",
                "stacked": false,
                "metrics": [
                    [
                        "AWS/RDS",
                        "ReadIOPS",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "period": 60
                        }
                    ],
                    [
                        ".",
                        "WriteIOPS",
                        ".",
                        ".",
                        {
                            "period": 60
                        }
                    ]
                ],
                "region": "us-west-2",
                "title": "RDS - CardDB - ReadWriteIOPs"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 6,
            "x": 6,
            "type": "metric",
            "properties": {
                "view": "timeSeries",
                "stacked": false,
                "metrics": [
                    [
                        "AWS/RDS",
                        "WriteLatency",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "period": 60
                        }
                    ],
                    [
                        ".",
                        "ReadLatency",
                        ".",
                        ".",
                        {
                            "period": 60
                        }
                    ]
                ],
                "region": "us-west-2",
                "title": "RDS - CardDB - ReadWriteLatency"
            }
        },
        {
            "height": 6,
            "width": 6,
            "y": 6,
            "x": 12,
            "type": "metric",
            "properties": {
                "view": "timeSeries",
                "stacked": false,
                "metrics": [
                    [
                        "AWS/RDS",
                        "FreeStorageSpace",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "period": 60
                        }
                    ]
                ],
                "region": "us-west-2",
                "title": "RDS - CardDB - FreeStorageSpace"
            }
        },
        {
            "height": 1,
            "width": 24,
            "y": 12,
            "x": 0,
            "type": "text",
            "properties": {
                "markdown": "## MySQL database health summary (friendscapstonerds)"
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 13,
            "x": 16,
            "type": "metric",
            "properties": {
                "title": "IO latency",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['os.diskIO.filesystem.await.avg', 'os.diskIO.nvme1n1.await.avg', 'os.diskIO.rdsdev.await.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "os.diskIO.filesystem.await",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "os.diskIO.nvme1n1.await",
                            "id": "e3",
                            "color": "#ff7f0e"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 2, 3))",
                            "label": "os.diskIO.rdsdev.await",
                            "id": "e4",
                            "color": "#2ca02c"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Milliseconds",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 13,
            "x": 8,
            "type": "metric",
            "properties": {
                "title": "EBS IO operations by volume",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['os.diskIO.nvme1n1.readIOsPS.avg', 'os.diskIO.nvme1n1.writeIOsPS.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "os.diskIO.nvme1n1.readIOsPS",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "os.diskIO.nvme1n1.writeIOsPS",
                            "id": "e3",
                            "color": "#ff7f0e"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Per second",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 19,
            "x": 16,
            "type": "metric",
            "properties": {
                "title": "IO throughput",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['os.diskIO.filesystem.readKbPS.avg', 'os.diskIO.filesystem.writeKbPS.avg', 'os.diskIO.nvme1n1.readKbPS.avg', 'os.diskIO.nvme1n1.writeKbPS.avg', 'os.diskIO.rdsdev.readKbPS.avg', 'os.diskIO.rdsdev.writeKbPS.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "os.diskIO.filesystem.readKbPS",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "os.diskIO.filesystem.writeKbPS",
                            "id": "e3",
                            "color": "#ff7f0e"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 2, 3))",
                            "label": "os.diskIO.nvme1n1.readKbPS",
                            "id": "e4",
                            "color": "#2ca02c"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 3, 4))",
                            "label": "os.diskIO.nvme1n1.writeKbPS",
                            "id": "e5",
                            "color": "#d62728"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 4, 5))",
                            "label": "os.diskIO.rdsdev.readKbPS",
                            "id": "e6",
                            "color": "#9467bd"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 5, 6))",
                            "label": "os.diskIO.rdsdev.writeKbPS",
                            "id": "e7",
                            "color": "#8c564b"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "KB per second",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 13,
            "x": 0,
            "type": "metric",
            "properties": {
                "title": "IO disk queue depth",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['os.diskIO.filesystem.avgQueueLen.avg', 'os.diskIO.nvme1n1.avgQueueLen.avg', 'os.diskIO.rdsdev.avgQueueLen.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "os.diskIO.filesystem.avgQueueLen",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "os.diskIO.nvme1n1.avgQueueLen",
                            "id": "e3",
                            "color": "#ff7f0e"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 2, 3))",
                            "label": "os.diskIO.rdsdev.avgQueueLen",
                            "id": "e4",
                            "color": "#2ca02c"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Requests",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 19,
            "x": 8,
            "type": "metric",
            "properties": {
                "title": "Network throughput",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['os.network.tx.avg', 'os.network.rx.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "os.network.tx",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "os.network.rx",
                            "id": "e3",
                            "color": "#ff7f0e"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Bytes per second",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 25,
            "x": 16,
            "type": "metric",
            "properties": {
                "title": "Connection utilization",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['db.Users.Threads_connected.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false,
                            "region": "us-west-2"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "db.Users.Threads_connected",
                            "id": "e2",
                            "color": "#1f77b4",
                            "region": "us-west-2"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Connections",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 19,
            "x": 0,
            "type": "metric",
            "properties": {
                "title": "Sessions",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['db.Users.Threads_running.avg', 'db.Users.Aborted_clients.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        "AWS/RDS",
                        "DBLoad",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "region": "us-west-2",
                            "label": "DBLoad",
                            "id": "m1",
                            "color": "#2ca02c"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "db.Users.Threads_running",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 1, 2))",
                            "label": "db.Users.Aborted_clients",
                            "id": "e3",
                            "color": "#d62728"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Sessions",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 25,
            "x": 0,
            "type": "metric",
            "properties": {
                "title": "Queries",
                "metrics": [
                    [
                        {
                            "expression": "DB_PERF_INSIGHTS('RDS', 'db-H5STRIMJJAKOXZIIZGX26QBTGI', ['db.SQL.Queries.avg'])",
                            "label": "",
                            "id": "e1",
                            "visible": false
                        }
                    ],
                    [
                        {
                            "expression": "FIRST(SLICE(e1, 0, 1))",
                            "label": "db.SQL.Queries",
                            "id": "e2",
                            "color": "#1f77b4"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Per second",
                        "showUnits": false
                    }
                }
            }
        },
        {
            "height": 6,
            "width": 8,
            "y": 25,
            "x": 8,
            "type": "metric",
            "properties": {
                "title": "BinLog disk usage",
                "metrics": [
                    [
                        "AWS/RDS",
                        "BinLogDiskUsage",
                        "DBInstanceIdentifier",
                        "friendscapstonerds",
                        {
                            "region": "us-west-2",
                            "label": "BinLogDiskUsage",
                            "id": "m1",
                            "color": "#1f77b4"
                        }
                    ]
                ],
                "region": "us-west-2",
                "view": "timeSeries",
                "stat": "Average",
                "period": 60,
                "yAxis": {
                    "left": {
                        "min": 0,
                        "label": "Bytes",
                        "showUnits": false
                    }
                }
            }
        }
    ]
}